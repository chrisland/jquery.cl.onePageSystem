/*
	
	onePageSystem - min
	
	
	Christian Marienfeld
	www.chrisland.de
	
	Version 1.3.1
	https://github.com/chrisland/onePageSystem
	
	
	Licence MIT

*/
var OPS=OPS||{};OPS.page=function(){var e={handler:"pageBtn",pages:"page",pagePrefix:"",displayStyle:"block",offButton:"pageBtnOffline",mockupDebug:!1,mockup:{}},t=0,a=0,n=0,r=[],o="#overlay",l=function(e){return"url(img/overlay/"+e+".svg)"},s={},i=function(n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);s=document.getElementsByClassName(e.pages);var o=s.length;if(o>1&&"number"==typeof o)for(var r=0;r<s.length;r++)if(s[r].style.display="none",e.mockup[s[r].id]){var l=g(e.mockup[s[r].id],r);s[r].appendChild(l)}for(var i=function(){var e=this.getAttribute("data-page"),t=this.getAttribute("data-task");(e||t)&&d(this)},u=document.getElementsByClassName(e.handler),r=0;r<u.length;r++)u[r].style.curser="pointer",u[r].addEventListener("click",i);return a?OPS.page.changePageById(a):e.start&&OPS.page.changePageById(e.start),t},g=function(t,a){var n=document.createElement("div");n.style.position="absolute",n.style.width=0,n.style.height=0,n.style.top=0,n.style.left=0;for(var r=0;r<t.length;r++){var o=t[r],l=document.createElement("button");l.style.position="absolute",l.style.zindex=9999999+a+r,l.style.left=o.x+"vw",l.style.top=o.y+"vh",l.style.width=o.width+"vw",l.style.height=o.height+"vh",l.style.border=1,l.style.outline=0,l.style.border=0,l.style.curser="pointer",l.style.backgroundColor="rgba(0,0,0,0)",1==e.mockupDebug&&(l.style.backgroundColor="rgba(255,200,0,0.5)",l.style.border="1px solid #ffc800",o.title&&(l.innerHTML=o.title)),l.setAttribute("class",e.handler),l.setAttribute("data-page",o.page),l.setAttribute("data-task",o.task),l.setAttribute("data-content",o.content),n.appendChild(l)}return n},u=function(e,t,a){var n=y(null,t,a,e);return n&&(fadePageDom(e),addPageHistory(e,t,a)),!1},d=function(t){if(t.classList.contains(e.offButton))return!1;var a=t.getAttribute("data-page"),n=t.getAttribute("data-task"),r=t.getAttribute("data-content"),o=y(t,n,r,a);return o&&(fadePageDom(a),addPageHistory(a,n,r)),!1},y=function(e,t,a,n){if("back"==t){var r=OPS.page.getPageHistory(),o=r[r.length-2];return o?(o.pageId&&(OPS.page.changePageById(o.pageId,o.pageTask,o.pageContent),OPS.page.kickLastPageHistory(2)),!0):!1}return OPS.task&&OPS.task[t]?OPS.task[t](n,a,e):!0};return fadePageDom=function(n){var r=document.getElementById(e.pagePrefix+n);if(n&&r){for(var o=0;o<s.length;o++)s[o].style.display="none";r.style.display=e.displayStyle,a=t,t=n}return!1},addPageHistory=function(e,t,a){if(e){var n={pageId:e,pageTask:t,pageContent:a};r.push(n)}},getPageHistory=function(){return r?r:!1},kickLastPageHistory=function(e){r=r.slice(0,r.length-e)},openOverlay=function(t,a){var r=document.getElementById(o);r.style.backgroundImage=l(t),r.style.display=e.displayStyle,a&&(clearTimeout(n),n=setTimeout(function(){closeOverlay()},a))},closeOverlay=function(){document.getElementById(o).style.display="none"},{initialize:i,changePageById:u,openOverlay:openOverlay,closeOverlay:closeOverlay}}();